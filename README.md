# Final Project for Harvard's GenEd 1179: Psychotherapy

## Overview:
This code is written to aid the evaluation of LLMs for the purposes of Psychotherapy as part of the final project for Harvard's GenEd 1179: Psychotherapy.

To begin, run "Main.py help"

## Functionalities:

The code contains three main functionalities:
1. To process Clinical Vignette PDFs, formatting each patient case into a single entry within a Jsonl file for either tuning or testing (querying) the LLM. This is accomplished in Parse_Data.py
2. To fine tune an LLM model based on provided Clinical Vignettes and diagnoses. This is accomplished in Fine_Tune_LLM.py
3. To query an LLM model with Clinical Vignettes and retrieving the LLM's predicted diagnosis. This is accomplished in Query_LLM.py

The three functionalities are utilized through Main.py, and the config.yaml file is used to specify file paths and model names as needed for each of the functionalities.

Note that for copyright reasons, the PDF copies of the Clinical Vignettes, as well as the final Tuning, Querying, and Output files which contain parsed versions of the Clinical Vignettes, are not featured in this repository

## Results:
The results of the project, alongside a detailed motivation and methodology can be found in "Final Paper.pdf", containing the paper submission for this project for the course.

It should be noted that due to the nature of the Clinical Vignettes referencing sensitive topics, queries were frequently rejected by the Google Gemini API endpoint and Google Gemini's User Interface. However, it was noted that a race condition with OpenAI's User Interface - similar to that mentioned [here](https://www.schneier.com/blog/archives/2024/11/race-condition-attacks-against-llms.html) by the renowned technologist Bruce Schneier - allowed for the model to generate a response, regardless of whether the inputted Clinical Vignette was flagged for supposedly violating usage policies. As such the final methodology involves manually querying GPT-4o via the user interface, using prompts generated by Parse_Data.py - as described in the Final Paper - as opposed to the Google Gemini Framework involving Fine_Tune_LLM.py and Query_LLM.py. As such, while the code in this repository was not used in its entirety for this project, it nonethless may serve as a reference for future work that may be more favorable to Fine-Tuning and Querying via Google's Gemini Series LLMs.